<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bikoe Bakery Order</title>
<style>
body {font-family:'Segoe UI', Tahoma, Geneva, Verdana,sans-serif;margin:0;padding:20px;background:linear-gradient(135deg,#ffe6cc,#fff5e6);}
.container {max-width:720px;margin:auto;background:#fffdf7;border-radius:20px;padding:25px;box-shadow:0 8px 25px rgba(0,0,0,0.12);}
h2{text-align:center;color:#d35400;font-size:26px;margin-bottom:15px;}
.menu-item {display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;padding:10px 12px;border-radius:12px;background:#fff3e0;box-shadow:0 3px 8px rgba(0,0,0,0.08);}
.menu-item input[type=checkbox]{transform:scale(1.3);margin-right:10px;}
.qty-wrapper {display:flex;align-items:center;gap:6px;}
.qty-wrapper button {width:30px;height:30px;border:none;border-radius:6px;background:#27ae60;color:#fff;font-weight:bold;font-size:16px;cursor:pointer;}
.qty-wrapper span {width:35px;text-align:center;font-weight:bold;}
.address-box{margin-top:20px;display:flex;flex-direction:column;}
.address-box label{margin-bottom:5px;font-weight:bold;color:#d35400;}
.address-box input{padding:10px;border-radius:10px;border:1px solid #ccc;font-size:14px;}
.note{margin-top:20px;padding:12px;background:#fff3e0;border:1px solid #f5b041;border-radius:10px;min-height:80px;white-space:pre-line;font-weight:500;}
.btn{display:block;width:100%;padding:14px;background:#27ae60;color:white;border:none;border-radius:12px;font-size:17px;cursor:pointer;margin-top:20px;transition:0.3s;}
.btn:hover{background:#1e8449;}
.admin-box{display:none;margin-top:20px;background:#fff3e0;padding:15px;border-radius:12px;border:1px solid #f5b041;}
.log-item{background:#fff;margin-bottom:8px;padding:8px;border-radius:8px;display:flex;justify-content: space-between;align-items:center;font-size:14px;box-shadow:0 2px 5px rgba(0,0,0,0.05);}
.log-item button{background:#e74c3c;color:#fff;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:12px;}
</style>
</head>
<body>
<div class="container">
<h2>Bikoe Bakery Order</h2>
<div id="menuContainer"></div>

<div class="address-box">
  <label>Nama Customer (opsional):</label>
  <input type="text" id="customerName" placeholder="Masukkan nama...">
  <label>Alamat / keterangan:</label>
  <input type="text" id="address" placeholder="Masukkan alamat / keterangan...">
  <label>Jarak (km, opsional):</label>
  <input type="number" id="jarakInput" min="0" value="0">
</div>

<div class="note" id="note">Pesanan akan muncul di sini...</div>

<button class="btn" onclick="sendOrder()">Pesanan Siap - Kirim WA</button>
<button class="btn" style="background:#3498db;margin-top:20px;" onclick="loginAdmin()">üîê Login Admin</button>

<div class="admin-box" id="adminBox">
  <h3>üìú Log Pesanan</h3>
  <div id="logList"></div>
  <button class="btn" onclick="saveLog()">üíæ Simpan Log</button>
  <button class="btn" onclick="printLog()">Cetak Log</button>
  <button class="btn" style="background:#e74c3c;margin-top:8px;" onclick="clearLog()">Hapus Semua Log</button>
</div>

<script>
// ===== DATA MENU =====
const menuList=[
  {category:'üçûROTI'},
  {name:'Roti Gandum (Tawar)', price:35000},
  {name:'Roti Toast (Beef)', price:22000},
  {name:'Roti Toast (Ayam)', price:20000},
  {category:'üçïPizza Jumbo (28‚Äì30cm)'},
  {name:'Pizza Sosis Sapi', price:115000},
  {name:'Pizza Sosis Ayam', price:100000},
  {name:'Pizza Smoked Beef', price:120000},
  {name:'Pizza Pepperoni', price:120000},
  {name:'Pizza Ikan Tuna', price:100000},
  {name:'Pizza Cheese Lovers', price:120000},
  {category:'üçïü§èüèªPizza Mini (7‚Äì10cm)'},
  {name:'Pizza Mini Sosis Sapi', price:5000}
];
const tarifPerKm=3000;
const biayaTambahan=8000;
let logs=[];

// ===== ELEMENTS =====
const menuContainer=document.getElementById('menuContainer');
const noteDiv=document.getElementById('note');
const customerInput=document.getElementById('customerName');
const addressInput=document.getElementById('address');
const jarakInput=document.getElementById('jarakInput');
const logList=document.getElementById('logList');

// ===== RENDER MENU =====
function renderMenu(){
  menuContainer.innerHTML='';
  let realIndex=0;
  menuList.forEach((item)=>{
    if(item.category){
      const cat=document.createElement('h3'); 
      cat.textContent=item.category;
      menuContainer.appendChild(cat);
      return;
    }
    const div=document.createElement('div'); 
    div.className='menu-item';
    div.dataset.index=realIndex;
    div.innerHTML=`
      <label><input type="checkbox"> ${item.name} - Rp${item.price.toLocaleString()}</label>
      <div class="qty-wrapper">
        <button class="minus">-</button>
        <span>0</span>
        <button class="plus">+</button>
      </div>`;
    menuContainer.appendChild(div); 
    realIndex++;
  });

  // Event listener checkbox & qty buttons
  menuContainer.querySelectorAll('.menu-item').forEach(div=>{
    const checkbox = div.querySelector('input[type=checkbox]');
    const qtySpan = div.querySelector('span');
    const minusBtn = div.querySelector('.minus');
    const plusBtn = div.querySelector('.plus');

    function updateQty(val){
      qtySpan.textContent = val;
      checkbox.checked = val>0;
      updateNote();
    }

    checkbox.addEventListener('change',()=>{
      if(checkbox.checked && parseInt(qtySpan.textContent)===0) updateQty(1);
      if(!checkbox.checked) updateQty(0);
    });

    plusBtn.addEventListener('click',()=>{
      let val = parseInt(qtySpan.textContent)||0;
      val++;
      updateQty(val);
    });

    minusBtn.addEventListener('click',()=>{
      let val = parseInt(qtySpan.textContent)||0;
      val = Math.max(0,val-1);
      updateQty(val);
    });
  });

  customerInput.addEventListener('input',updateNote);
  addressInput.addEventListener('input',updateNote);
  jarakInput.addEventListener('input',updateNote);
}

// ===== UPDATE NOTE =====
function updateNote(){
  let selected=[]; let total=0;
  menuContainer.querySelectorAll('.menu-item').forEach(div=>{
    const qty = parseInt(div.querySelector('span').textContent)||0;
    if(qty>0){
      const item = menuList.filter(i=>i.name)[parseInt(div.dataset.index)];
      selected.push(`${item.name} x${qty} = Rp${(item.price*qty).toLocaleString()}`);
      total += item.price*qty;
    }
  });

  const jarak = parseFloat(jarakInput.value)||0;
  if(jarak>0){
    const biayaJarak = (jarak*tarifPerKm)+biayaTambahan;
    selected.push(`Biaya Jarak (${jarak} km + Rp${biayaTambahan.toLocaleString()}) = Rp${biayaJarak.toLocaleString()}`);
    total += biayaJarak;
  }

  const customerText = customerInput.value.trim()?`Nama: ${customerInput.value.trim()}`:'';
  const addressText = addressInput.value.trim()?`Alamat/keterangan: ${addressInput.value.trim()}`:'';
  noteDiv.textContent = selected.length>0 ? selected.join('\n')+`\nTotal: Rp${total.toLocaleString()}\n${customerText}\n${addressText}` : 'Pesanan akan muncul di sini...';
}

// ===== SEND ORDER =====
function sendOrder(){
  let selectedItems=[]; let total=0;
  menuContainer.querySelectorAll('.menu-item').forEach(div=>{
    const qty = parseInt(div.querySelector('span').textContent)||0;
    if(qty>0){
      const item = menuList.filter(i=>i.name)[parseInt(div.dataset.index)];
      selectedItems.push(`${item.name} x${qty} = Rp${(item.price*qty).toLocaleString()}`);
      total += item.price*qty;
    }
  });
  const jarak = parseFloat(jarakInput.value)||0;
  if(jarak>0){
    const biayaJarak = (jarak*tarifPerKm)+biayaTambahan;
    selectedItems.push(`Biaya Jarak (${jarak} km + Rp${biayaTambahan.toLocaleString()}) = Rp${biayaJarak.toLocaleString()}`);
    total += biayaJarak;
  }

  if(selectedItems.length===0){alert('Silakan pilih menu terlebih dahulu!'); return;}
  const customerText = customerInput.value.trim()?`Nama: ${customerInput.value.trim()}`:'';
  const addressText = addressInput.value.trim()?`Alamat/keterangan: ${addressInput.value.trim()}`:'';
  const message=`Halo, saya ingin memesan:\n${selectedItems.join('\n')}\nTotal: Rp${total.toLocaleString()}\n${customerText}\n${addressText}`;
  const phone='6285753556390';
  window.open(`https://wa.me/${phone}?text=${encodeURIComponent(message)}`,'_blank');
}

// ===== ADMIN LOGIN & LOG =====
function loginAdmin(){
  const pass = prompt('Password admin:');
  if(pass==='KELUARGACEMARA'){
    document.getElementById('adminBox').style.display='block';
    const savedLogs = localStorage.getItem('logPesanan');
    if(savedLogs) logs = JSON.parse(savedLogs);
    renderLog();
  } else alert('Password salah!');
}

function renderLog(){
  logList.innerHTML='';
  logs.forEach((log,i)=>{
    const div = document.createElement('div');
    div.className='log-item';
    div.innerHTML=`<div>
      ${log.time}<br>
      ${log.items.join('<br>')}<br>
      Total: Rp${log.total.toLocaleString()}<br>
      ${log.customer}<br>
      ${log.address}<br>
      Terimakasih kak sudah memesan di Bikoe Bakery
    </div>`;
    const btn = document.createElement('button'); 
    btn.textContent='Hapus'; 
    btn.onclick=()=>{logs.splice(i,1); renderLog();};
    div.appendChild(btn);
    logList.appendChild(div);
  });
}

// ===== SAVE, CLEAR, PRINT =====
function saveLog(){
  let selectedItems=[]; let total=0;
  menuContainer.querySelectorAll('.menu-item').forEach(div=>{
    const qty = parseInt(div.querySelector('span').textContent)||0;
    if(qty>0){
      const item = menuList.filter(i=>i.name)[parseInt(div.dataset.index)];
      selectedItems.push(`${item.name} x${qty} = Rp${(item.price*qty).toLocaleString()}`);
      total += item.price*qty;
    }
  });
  const jarak = parseFloat(jarakInput.value)||0;
  if(jarak>0){
    const biayaJarak = (jarak*tarifPerKm)+biayaTambahan;
    selectedItems.push(`Biaya Jarak (${jarak} km + Rp${biayaTambahan.toLocaleString()}) = Rp${biayaJarak.toLocaleString()}`);
    total += biayaJarak;
  }
  const customerText = customerInput.value.trim()?`Nama: ${customerInput.value.trim()}`:'';
  const addressText = addressInput.value.trim()?`Alamat/keterangan: ${addressInput.value.trim()}`:'';
  if(selectedItems.length===0){alert('Tidak ada menu dipilih!'); return;}
  logs.push({items:selectedItems,total,customer:customerText,address:addressText,time:new Date().toLocaleString()});
  localStorage.setItem('logPesanan', JSON.stringify(logs));
  renderLog();
  alert('Log tersimpan dan siap dicetak!');
}

function clearLog(){
  if(confirm('Hapus semua log?')){
    logs = [];
    localStorage.removeItem('logPesanan');
    renderLog();
  }
}

function printLog(){
  const w = window.open('','','width=800,height=600');
  w.document.write('<pre>' + logs.map(l=>`${l.time}\n${l.items.join('\n')}\nTotal: Rp${l.total.toLocaleString()}\n${l.customer}\n${l.address}`).join('\n\n') + '</pre>');
  w.print();
}

// ===== INIT =====
renderMenu();
</script>
</body>
</html>
